/*!
 * C-Like Data Structure for JavaScript.
 *
 * @author Joon Kyoung (aka. Firejune)
 * @license MIT
 * @version 0.2.3
 *
 */

(function(u,r){function p(a){return!!a&&a.constructor===Array}function n(a){return!!a&&a.constructor===String}function e(a,c){var b={},f;for(f in a)if(a.hasOwnProperty(f)){var l=a[f];l&&l.constructor===Object?b[f]=e(l,c):c(l,f,b)}return b}function s(a,c){for(var b in c)a.hasOwnProperty(b)&&(n(a[b])&&(a[b]=[a[b],0]),a[b]&&a[b].constructor===Object?a[b]=s(a[b],c[b]):a[b][1]=c[b]);return a}function v(a,c){return e(a,function(b,a,l){var w=(p(b)&&b[0]||b).toLowerCase(),d=n(b)?c:b[1];b=p(b)&&3==b.length&&
b[2]||(n(d)||p(d))&&d.length||1;l[a]=[w,d,b]})}function x(a){var c=0;e(a,function(b){c+=q[b[0]]*b[2]});return c}var q={int8:1,uint8:1,int16:2,uint16:2,int32:4,uint32:4,float32:4,float64:8},t=function(a,c,b){this.endian=b==r&&!0||b;this.defaultValue=c||0;this.struct=v(a,this.defaultValue);this.byteLength=x(this.struct);this.emptyBuffer=new ArrayBuffer(this.byteLength)};t.prototype={read:function(a,c){var b,f=this,l=this.endian;b=a instanceof DataView?a:new DataView(a);this.offset=c||0;return e(this.struct,
function(a,c,g){var k=[],m=a[0],h=a[1];a=a[2];for(var e=0;e<a;)k[e]=b["get"+(m.charAt(0).toUpperCase()+m.slice(1))](f.offset,l),f.offset+=q[m],e++;if(n(h)||p(h)||1<a){if(n(h)){m=[];h=k.length;for(a=0;a<h;)m[a]=String.fromCharCode(k[a]),a++;k=m.join("")}g[c]=k}else g[c]=k[0]})},write:function(a){var c=new DataView(this.emptyBuffer),b=this.endian,f=0;a!=r&&(this.struct=s(this.struct,a));e(this.struct,function(a){var e=a[0],d=a[1];a=a[2];if(n(d)||p(d)||1<a){var g;if(g=n(d)){g=d;for(var k=[],m=g.length,
h=0;h<m;)k[h]=g.charCodeAt(h),h++;g=k}d=g||d}else d=[d];for(g=0;g<a;g++)c["set"+(e.charAt(0).toUpperCase()+e.slice(1))](f,d[g],b),f+=q[e]});return c.buffer}};u.Struct=t})(window);